# База промисов

* Основная идея промиса.
  * Промисы и callback-hell.
* Колбэк для промиса с параметрами resolve и reject.
  * Необязательность параметров resolve и reject.
  * Состояние промиса, если не вызвать resolve и reject.
* Возможные состояния промиса.
  * Промис создается как peding-промис.
  * Завершенный успешно, fullfilled-промис.
  * Завершенный с ошибкой (отклоненный), rejected-промис.
* Момент, когда колбэк начинает выполнение.
  * Синхронное выполнение, асинхронная обработка результата, event loop.
  * Промис выполняется один раз, повторное выполнение невозможно.
* Получение доступа к результату или ошибке промиса.
  * Непосредственное извлечение результата из объекта промиса невозможно.
  * Метод then с двумя параметрами.
  * Метод catch.
* Выполнение "очищающих" действий.
  * Метод finally.
* Ошибки в промисе.
  * Асинхронные ошибки в промисе.
  * Непойманное исключение в промисе.
* Объединение методов then, catch и finally в цепочки.
  * Каждый из них возвращает новый pending-промис.
* Механики работы then, catch и finally.
  * Переход нового промиса в fullfilled или rejected состояние на основании колбэка в методе.
    * Состояние и данные нового промиса, когда колбэк не срабатывает.
  * Состояние и данные нового промиса, когда колбэк срабатывает.
    * Если колбэк вернул объект или примитив.
    * Если колбэк не вернул ничего.
    * Если колбэк вернул промис.
    * Если в колбэке произошла ошибка.



# API промисов

* Метод `Promise.all()` и `Promise.allSettled()`
  * Принимают итерируемый объект с промисами.
  * Результат метода - pending-промис.
    * Он завершается, когда завершатся все переданные промисы.
    * Результат этого промиса - массив результатов выполнившихся промисов.
      * Порядок выполнившихся промисов и порядок их результатов в массиве.
      * Если все промисы выполнились успешно.
      * Если один промис не выполнился.
        * `{ status, value }`
* Метод `Promise.race()`
  * Принимает итерируемый объект с промисами.
  * Результат метода - pending-промис.
    * Он завершается, когда завершится любой из переданных промисов.
    * Его результатом становится результат этого промиса, неважно успешный он или с ошибкой.
* Метод `Promise.any()`
  * Принимает итерируемый объект с промисами.
  * Результат метода - peding-промис.
    * Когда какой-нибудь из переданных промисов завершается успешно, то и этот промис завершается с этим успешным результатом.
    * Если все промисы завершились провалом, то этот промис становится rejected, а его данные - это массив с объетами ошибок.
* Методы `Promise.resolve()` и `Promise.reject()`
  * Позволяют сразу создать уже завершенный промис с результатом.
    * Обычно используются, когда метод должен вернуть промис, но результат уже известен и вычислений проводить не надо.



# async \ await

* `async` и `await` - синтаксический сахар над промисами, позволяющий писать асинхронный код, который с виду поход на синхронный.
* `async` применяется к описанию функции.
  * Оборачивает результат функции в промис.
    * Если функция выполнилась без ошибок.
    * Если в функции была ошибка.
* `await` применяется к вызову функции, которая возвращает промис.
  * Если промис - это fullfilled-промис.
  * Если промис - это rejected-промис.



# Event Loop

* Движок и среда выполнения.
  * Движок - понимает JS-код.
    * Задачи.
      * JIT-компиляция (just-in-time).
        * Фрагмент кода, подлежащий выполнению, компилируется единожды непосредственно перед выполнением и остается в памяти на случай, если понадобится снова.
    * V8 - Chrome, Node JS.
    * SpiderMonkey - Firefox.
  * Среда выполнения - предоставляет дефолтные возможности, вроде работы с файловой системой, структурой документа, Event Loop.
* Event Loop.
  * Синхронные операции - в стек.
  * Асинхронные операции - в очередь.
  * Условное деление на микро- и макрозадачи.
    * Выбор задачи для выполнения и помещение ее в стек.

