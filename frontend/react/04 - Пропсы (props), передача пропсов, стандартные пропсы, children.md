# Пропсы

## Использование пропсов в компоненте

Пропсы - это некоторые входные данные для компонента. Можно сказать, параметры для него, т.к. компонент это по сути функция.

Компонент с пропсами:

```react
const Info = (props) => {  // <-- Пропсы - это просто параметр функции
  console.log(props);
  return (
    <div>
      <h1>{props.header}</h1>  <!-- Извлекаем нужные данные из пропсов -->
      <div>{props.article.title}</div>
      <div>{props.article.author}</div>
      <div>{props.article.content}</div>
    </div>
  );
};

export default Info;
```

## Передача пропсов в компонент

Чтобы пользоваться пропсами в компоненте, нужно их туда передать:

```react
<Info header={"Важная информация"} 
      article={{title: "О наркотиках", 
                author: "Мистер Маки", 
                content: "Наркотики - эт плохо, пнятненько?"
               }}
    />
```

* Все "атрибуты" компонента собираются в пропс. В данном случае в пропсах будет два поля - header и article.
* Значение "атрибуту" задается через фигурные скобки `{}`.
  * Значением может быть как простое значение, так и сложный объект.

# Деструктуризация пропсов и оператор расширения

При работе с пропсами важно и полезно знать возможности JS по деструктуризации объектов и как работает оператор расширения. Эти темы разобраны в конспектах по JS, а тут просто демонстрация как они могут быть полезны в реакте.

## Деструктуризация

Пусть props имеет такую структуру:

```
{
  header,
  article: {
    title,
    author,
    content
  }
}
```

```react
<Info header={"Важная информация"} 
      article={{title: "О наркотиках", 
                author: "Мистер Маки", 
                content: "Наркотики - эт плохо, пнятненько?"
               }}
    />
```

Внутри компонента мы можем воспользоваться деструктуризацией, чтобы не писать каждый раз `props.`:

```react
const Info = ({header, article}) => {  // <-- Деструктуризируем пропсы
  return (
    <div>
      <h1>{header}</h1>  <!-- Нет нужды теперь писать props.header -->
      <div>{article.title}</div>
      <div>{article.author}</div>
      <div>{article.content}</div>
    </div>
  );
};

export default Info;
```

## Оператор расширения

Оператор расширения удобно использовать в комбинации с деструктуризацией. Мы можем выдрать из пропсов отдельные поля, а остальные собрать обратно в объект с помощью оператора расширения. 

Рассмотрим это на синтетическом примере. Более полезный пример будет в разделе про стандартные пропсы и children.

Пусть у нас компонент используется вот так:

```react
<Info header={"Важная информация"} 
      title={"О наркотиках"} 
      author={"Мистер Маки"} 
      content={"Наркотики - эт плохо, пнятненько?"}
  />
```

Здесь пропсы title, author и content логически можно объединить в один объект, например `article` для наглядности. В то время как header это что-то самостоятельное. Но как видно при вызове компонента, все атрибуты передаются "плоско". Мы можем использовать дестуктуризацию и оператор расширения, чтобы придать пропсам нужную структуру:

```react
const Info = ({header, ...article}) => {
  return (
    <div>
      <h1>{header}</h1>
      <div>{article.title}</div>
      <div>{article.author}</div>
      <div>{article.content}</div>
    </div>
  );
};

export default Info;
```

Мы выдираем из пропсов header в отдельную переменную, а все оставшиеся поля с помощью оператора расширения собираем в переменную article.

# Стандартные пропсы

## children

Этот пропс содержит в себе контент компонента. Например:

```react
<MyButton>Создать</MyButton>
```

```react
const MyButton = ({children, ...rest}) => {
  return (
    <button {...rest}>{children}</button>
  );
};
```

Здесь children будет содержать надпись "Создать".

Комментарий насчет синтаксиса. Изначально props содержит children, плюс все "атрибуты", установленные компоненту. Например, если написать `<MyButton disabled>Создать</MyButton>`, то объект props переданный компоненту, будет содержать два свойства - children и disabled. Конструкцией `{children, ...rest}` мы выдергиваем свойство children в одноименную переменную, а все оставшиеся свойства обратно собираем в объект rest. В данном случае там окажется одно свойство - disabled. Далее через`<button {...rest}` мы обратно разбиваем объект rest на свойства и у кнопки оказывается свойство disabled. Таким образом можно задать компоненту разные атрибуты, актуальные для кнопки, и все они окажутся внутри подлежащей кнопки.

# Направление передачи пропсов

Пропсы передаются от родителя к ребенку, обратная передача невозможна, потому что дети очевидно не знают где они используются.

Передача в обратную сторону возможна через колбэки. Если родитель передает ребенку колбэк через пропсы, то ребенок может этот колбэк вызвать и передать в него нужные родителю данные.

Например, задача с созданием постов. Есть два компонента:

* Форма для написания поста, например PostForm.
* Список, отображающий посты, например PostList.

Эти два компонента объединяются в один более крупный, например, Diary. В нем хранится состояние в виде всех имеющихся постов. Он передает их в список для отображения. А компонент PostForm должен как-то вернуть компоненту Diary объект нового поста. Вот тут-то и пригождается колбэк.

Компонент PostForm для написания поста:

```react
import {useState} from 'react';
import MyInput from './ui/input/MyInput';
import MyButton from './ui/button/MyButton';

const PostForm = ({createNewPost}) => {  // <-- Через пропсы принимаем колбэк

  const [post, setPost] = useState({ title: '', body: '' });

  const addNewPost = (event) => {
    event.preventDefault();
    createNewPost({...post, id: Date.now()});  // <-- Через колбэк передаем родителю пост
    setPost({ title: '', body: '' });
  };

  return (
    <form>
      <MyInput type="text" placeholder="Заголовок поста" value={post.title} 
              onChange={event => setPost({...post, title: event.target.value})} />
      <MyInput type="text" placeholder="Содержание поста" value={post.body} 
              onChange={event => setPost({...post, body: event.target.value})} />
      <MyButton onClick={addNewPost}>Создать</MyButton>
    </form>
  );
};

export default PostForm;
```

Родительский компонент, Diary:

```react
function App() {
  const [posts, setPosts] = useState([
    {id: 1, title: 'Javascript', body: 'Javascript - это язык программирования.'},
    {id: 2, title: 'Java', body: 'Java - это язык программирования, в основном используется на бэкэнде.'},
    {id: 3, title: 'C#', body: 'C# - это как Java, только лучше.'}
  ]);

  const createPost = (post) => {  // <-- Создаем колбэк, в который ребенок передаст новый пост
    setPosts([...posts, post]);  // <-- Добавляем этот пост к состоянию
  };

  return (
    <div className="App">
      <PostForm createNewPost={createPost} />  <!-- Передаем ребенку колбэк -->
      <PostList title={"Посты"} posts={posts} />
    </div>
  );
}

export default App;
```

