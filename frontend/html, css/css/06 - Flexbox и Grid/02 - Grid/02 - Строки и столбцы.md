# Разметка для примеров

```html
<body>
  <div>Для писем и газет</div>
  <div class="grid-container">
    <div class="grid-element">Раз</div>
    <div class="grid-element">Два</div>
    <div class="grid-element">Три</div>
    <div class="grid-element">Четыре</div>
    <div class="grid-element">Пять</div>
    <div class="grid-element">Шесть</div>
    <div class="grid-element">Семь</div>
    <div class="grid-element">Восемь</div>
    <div class="grid-element">Девять</div>
    <div class="grid-element">Десять</div>
    <div class="grid-element">Одиннадцать</div>
    <div class="grid-element">Двенадцать</div>
    <div class="grid-element">Тринадцать</div>
    <div class="grid-element">Четырнадцать</div>
    <div class="grid-element">Пятнадцать</div>
    <div class="grid-element">Шестнадцать</div>
  </div>
</body>
```

```css
.grid-container {
  display: grid;
  grid-auto-flow: rows;
  grid-template-columns: auto auto auto;
  /* grid-template-rows: 50px 75px; */
  /* grid-auto-rows: 30px; */
  /* grid-auto-columns: 120px; */
  /* justify-items: start; */
  /* justify-content: start; */
  /* align-items: start; */
  /* align-content: start; */
  /* height: 100px; */
  background-color: bisque;
}

.grid-element {
  background-color: aqua;
  padding: 5px;
}

.large {
  font-size: 35px;
}

.ghost {
  background-color: #EAEAEA;
  border: 1px dashed #404040;
}
```

# grid-auto-flow, Направление добавления элементов

Грид-контейнер состоит из строк и столбцов (колонок). Направление добавления элементов, задается свойством `grid-auto-flow`:

* `grid-auto-flow: row` (дефолт) - элементы добавляются в строку. Когда вся строка заполнена, добавляется новая строка.
* `grid-auto-flow: column` - элементы добавляются в столбец. Когда весь столбец заполнен, добавляется новый столбец.

![auto-flow-demo.drawio](img/auto-flow-demo.drawio.svg)

# Количество строк и столбцов

Чтобы грид понимал, когда надо начинать новую строку, ему нужно знать, сколько должно быть столбцов:

```css
.grid-container {
  grid-auto-flow: row;  /* Направление заполнения - строка */
  /* А сколько должно быть столбцов? Когда мне начинать новую строку? */
}
```

Аналогично, чтобы начать новый столбец, ему надо знать, сколько должно быть строк:

```css
.grid-container {
  grid-auto-flow: column;  /* Направление заполнения - столбец */
  /* А сколько должно быть строк? Когда мне начинать новый столбец? */
}
```

Указать точное количество строк и столбцов, например, 5 столбцов и 3 строки - нельзя. Таких свойств нет, потому что в грид можно добавить как 2 элемента, так и 200, соответственно размер грида в этих случаях очевидно разный. 

Но есть свойства-шаблоны `grid-template-columns` и `grid-template-rows`, которые могут повлиять на количество столбцов и строк.

# Шаблоны строк и столбцов

## grid-template-columns и grid-template-rows шаблоны

https://developer.mozilla.org/en-US/docs/Web/CSS/grid-template-rows

### На что влияют

Для столбцов и строк мы можем задать шаблоны с помощью свойств `grid-template-columns` и `grid-template-rows`:

* `grid-template-columns`
  * Задает ширину столбцов.
  * В случае заполнения по строке влияет на количество столбцов.
* `grid-template-rows`
  * Задает высоту строк.
  * В случае заполнения по столбцу влияет на количество строк.

У обоих свойств одинаковый синтаксис:

```css
.grid-container {
  grid-template-rows: значение значение значение;  /* Шаблон для трех строк */
}
```

```css
.grid-container {
  grid-template-columns: значение значение;  /* Шаблон для двух столбцов */
}
```

Например:

<img src="img/row-column-templates.drawio.svg" alt="row-column-templates.drawio"  />

Может сложиться впечатление, что по одной из осей грид всегда будет иметь фиксированное количество элементов. Однако с помощью функции `repeat` можно сделать так, чтобы количество элементов по направлению заполнения рассчитывалось автоматически, исходя из доступного места по этой оси. Подробнее - дальше, в разделе про эту функцию.

### Совместное использование grid-template-columns и grid-template-rows

Свойства `grid-template-columns` и `grid-template-rows` не взаимоисключающие. Их можно использовать вместе, с учетом одного нюанса: если направление заполнения - строка, то `grid-template-row` задаст высоту только для перечисленных строк:

```css
.grid-container {
  grid-auto-flow: row;  /* Направление заполнения - строка */
  grid-template-columns: auto auto auto;
  grid-template-rows: 50px 75px;  /* Задаст высоту только для первых двух строк */
}
```

Аналогично, если направление заполнения - столбец, то `grid-template-rows` задаст ширину только для перечисленных столбцов:

```css
.grid-container {
  grid-auto-flow: column;  /* Направление заполнения - столбец */
  grid-template-rows: auto auto;
  grid-template-columns: 100px 150px 300px;  /* Задаст ширину только для первых трех столбцов */
}
```

Т.о., шаблон для "автоматической оси" задает ширину \ высоту только для количества перечисленных столбцов \ строк. Если же их окажется больше, чем в шаблоне, то он сработает только на несколько первых, а остальные получат размеры по умолчанию.

Поэтому совместное использование `grid-template-columns` и `grid-template-rows` больше всего подходит для случаев, когда заранее четко известно количество и строк, и столбцов. Например, когда грид используется для построения сетки страницы и, следовательно, по макету страницы сразу понятна структура строк и столбцов.

Если же грид используется для отображения произвольного количества элементов (например, каталог товаров), а следовательно количество строк \ столбцов может варьироваться, то в случае необходимости задать шаблон для "динамических" строк \ столбцов, нужно пользоваться свойствами `grid-auto-rows` и `grid-auto-columns`. О них в отдельном разделе.



## "Авто"-шаблоны grid-auto-rows и grid-auto-columns

https://developer.mozilla.org/en-US/docs/Web/CSS/grid-auto-rows

Свойства `grid-auto-rows` и `grid-auto-columns` задают шаблоны для строк \ столбцов, которые получаются в результате переполнения. В этом шаблоне можно указать несколько значений, тогда они будут применяться циклически. Допустим, задали два значения, значит они сработают на 1 и 2 строки, потом на 3 и 4, 5 и 6 и т.д. Задали три значения, значит на 1, 2, 3, потом на 4, 5, 6, потом на 7, 8, 9 и т.д. Если одновременно с этим использовать `grid-template-rows` \ `grid-template-columns`, то для первых нескольких строк \ столбцов возьмется шаблон из них, а для остальных - "циклический".

Наглядно (на примере заполнения по строке, но при заполнении по столбцу тот же принцип):

![grid-auto-rc-template.drawio](img/grid-auto-rc-template.drawio.svg)

## Значения для шаблонов

### Разметка для примеров

```html
<body>
  <div class="grid-container">
    <div class="grid-element">Слон</div>
    <div class="grid-element">Гиппопотам</div>
    <div class="grid-element">Орангутанг</div>
    <div class="grid-element">Уж</div>
    <div class="grid-element">Кот</div>
  </div>
</body>
```

```css
* {
  box-sizing: border-box;
}

.grid-container {
  display: grid;
  grid-auto-flow: column;
  grid-template-rows: auto auto;
  background-color: bisque;
  padding: 5px;
}

.grid-element {
  background-color: #EAEAEA;
  padding: 5px;
  border: 1px solid black;
  text-align: center;
}
```

### auto

Ширина столбцов \ высота строк вычисляется автоматически так, чтобы заполнить весь контейнер по соответствующей оси. При этом учитывается размер элементов. Например, `grid-template-columns: auto 100px auto` означает, что вторая колонка будет шириной 100px, а оставшееся в контейнере горизонтальное пространство разделится между первой и третьей колонкой *пропорционально* их контенту.

<img src="img/gtv-auto.drawio.svg" alt="gtv-auto.drawio" style="zoom:80%;" />

Из-за того, что слово "Орангутанг" длиннее "Слона", третий столбец получил больше пространства при auto-распределении.

### fr

`fr` от "fraction", позволяет делить пространство на основе коэффициентов. Если у двух строк \ столбцов одинаковый коэффициент, то они разделят все свободное пространство поровну, независимо от размера своего контента.

<img src="img/gtv-fr.drawio.svg" alt="gtv-fr.drawio" style="zoom:80%;" />

На этот раз слон и орангутанг получили поровну ширины, т.к. для них указан одинаковый коэффициент распределения.

### Положительное число

Ширина столбца \ высота строки задается конкретным значением и будет ровно столько, сколько указано, не зависимо от размера контента. Если контент не поместится в заданный размер, он просто визуально вылезет.

<img src="img/gtv-value.drawio.svg" alt="gtv-value.drawio" style="zoom:80%;" />

Из-за слишком маленькой ширины столбцов гиппопотам пересекся с орангутангом, а кот наполовину оказался на улице.

### Функция minmax(a, b)

Ширина будет не меньше `a` и не больше `b`, а между этими значениями будет занимать столько, сколько нужно. Возможные значения для a и b:

* `100px` - конкретное число в пикселях или других единицах.
* `20%` - процент берется от размера соответствующей оси грид-контейнера.
* `2fr` - значение через fr пока допускается только для максимального значения. Например, `grid-template-column: minmax(200px, 1fr) 1fr 1fr;` означает, что если места в оси много и его хватает, чтобы сделать все три столбца одинаковыми по ширине, то они будут одинаковыми. Если не хватает, то 2 и 3 будут одинаковыми, а первый - сколько достанется (но не меньше 200px).
* `max-content` - ключевое слово, которое означает такой размер строки \ столбца, чтобы элемент поместился без переноса контента.
* `min-content` - ключевое слово, которое означает такой размер строки \ столбца, при котором элемент занимает минимальный размер после переноса контента. Грубо говоря, длина самого длинного слова в строке.
* `auto`
  * Если используется как максимальное значение, то это размер элемента без переносов (типа как max-content).
  * Если используется как минимальное значение, тогда подразумевает значение min-width \ min-height элемента. TODO: а если они не заданы? Проверять сейчас некогда, потом чекнуть.

### Функция repeat

https://developer.mozilla.org/en-US/docs/Web/CSS/repeat

Позволяет сделать несколько столбцов \ строк с одинаковыми размерами. Например `grid-template-columns: repeat(3, 150px)` сделает три столбца по 150px каждый. Можно использовать вместе с другими способами: `grid-template-columns: repeat(3, 150px) 100px auto` - получится 5 столбцов.

В качестве размера можно указать значения в пикселях (и прочих единицах, типа rem), процентах, fr и функцию minmax.

#### auto-fill и auto-fit, первый параметр

В качестве первого параметра можно указывать не конкретное число, а значения `auto-fill` или `auto-fit`, чтобы браузер автоматически выявил чисто столбцов (или строк).

В своей основе они работают одинаково (на примере столбцов, но для строк все то же самое):

* Браузер берет ширину столбца из второго параметра функции repeat и создает в строке столько столбцов, сколько может влезть в нее, исходя из ширины контейнера. Можно назвать эти столбцы "виртуальными".
* Затем заполняет строку элементами грида.
* Если элементов оказалось больше, чем "виртуальных" столбцов, то строка переполняется и не поместившиеся элементы добавляются в новую строку. В этом случае разницы между auto-fill и auto-fit не будет.
* Если элементы не вызвали переполнение строки, тогда:
  * `auto-fill` заполнит столько "виртуальных" столбцов, сколько сможет, а остальные оставит пустыми. При этом они все равно визуально будут занимать пространство строки.
  * `auto-fit` заполнит столько "виртуальных" столбцов, сколько сможет, а остальные уничтожит. Освободившееся место равномерно распределит между оставшимися столбцами.

Наглядные примеры:

![repeat-auto-fill-fit-diff.drawio](img/repeat-auto-fill-fit-diff.drawio.svg)

#### Размер, второй параметр

Если в функции repeat мы используем auto-fill или auto-fit, то получаем ограничения на значения для второго параметра, а именно:

* Размер можно указать конкретным числом или в процентах. Тут ничего хитрого - что укажем, такого размера элементы и будут.

* Размер можно задать через функцию `minmax` с такой комбинацией параметров min и max:

  * **min:** `число | проценты`,  **max:** `число | проценты | fr | min-content | max-content | auto`
  * **min:** `число | проценты | fr | min-content | max-content | auto`, **max:** `число | проценты`

  Оба варианта являются инверсией друг друга. Т.е. если первый параметр использует не конкретное число, то второй обязан быть конкретным, и наоборот.

#### Выводы по repeat + auto-fill | auto-fit

* Неспроста при использовании auto-fill и auto-fit надо передавать в minmax хотя бы одну конкретную цифру \ процент. Оба алгоритма опираются на нее при создании виртуальных элементов. Потом они делают свою стандартную работу и при этом учитывают второе значение размера, чтобы в итоге элементы не получились больше \ меньше, чем указано.
* Поэтому нужно хорошо понять базу и просто подумать, тогда все примеры ниже станут очевидными.

Примеры:

► Когда в minmax передано два числа, то auto-fill и auto-fit ведут себя одинаково: пока свободного места много, все элементы имеют размер, указанный в max. Когда места начинает не хватать, элементы начинают переноситься на новую строку, но все еще остаются максимального размера. Когда места начинает не хватать прямо очень сильно, элементы начинают сжиматься (но не сильнее, чем указано в min):

![repeat-minmax-num-num.drawio](img/repeat-minmax-num-num.drawio.svg)

► Когда в minmax передано число и fr, то auto-fill сделает все элементы размером с это число, а fr по сути ни на что не повлияет. auto-fit же в случае свободного места растянет элементы, чтобы они занимали все доступное место (элементы будут одинакового размера). Это объясняется базовой механикой работы auto-fill и auto-fit. Такой же эффект будет, если вместо fr использовать `auto`.

![repeat-minmax-num-fr.drawio](img/repeat-minmax-num-fr.drawio.svg)

► Когда в minmax передано число и `max-content`, то auto-fill даст всем элементам min-размер. auto-fit при наличии свободного места попытается распределить его между элементами, чтобы они были одинаковые и занимали все место, но из-за того, что размер ограничен максимальным размером контента, каждый элемент получит свой уникальный размер.

![repeat-minmax-num-maxcontent.drawio](img/repeat-minmax-num-maxcontent.drawio.svg)

► Когда в minmax передано `min-content` / `max-content` и число, то auto-fill и auto-fit ведут себя одинаково. Они берут число и если оно больше, чем min, тогда элементы будут размером как это число. Если число меньше, тогда элементы будут min-размера.

![repeat-minmax-mmcontent-num.drawio](img/repeat-minmax-mmcontent-num.drawio.svg)

► Когда в minmax передано fr и число, оба алгоритма растянут каждый элемент на всю ширину.

# Расстояние между строками и колонками

```css
row-gap: 20px;
column-gap: 40px;
gap: 20px 40px;  /* row + column */
gap: 40px;  /* row + column, одно значение и для того, и для другого */
```

# Порядок

```css
.grid-element {
  order: -1;
}
```

* `-1` элемент встает в самое начало.
* `1` элемент встает в конец.

