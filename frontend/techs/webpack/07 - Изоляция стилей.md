# Изоляция стилей

Когда проект большой, то много селекторов могут иметь одинаковые имена, вроде `.open`. Из-за этого они будут накладываться друг на друга и конфликтовать. Даже именование по БЭМ может приводить изредка к конфликтам.

Поэтому существует т.н. изоляция стилей. При сборке вебпак переименует селекторы в хэши и т.о. имена получатся гарантированно уникальными.





# Пример

В имя файла со стилями надо добавить слово `module`, например `App.module.scss`

```css
.nicep {
  color: red;
  background-color: aquamarine;
  font-size: 40px;
}
```

Для использования стилей, файл с ними импортируется в объект, а все селекторы становятся полями этого объекта (см. конспект по реакту как это работает):

```react
import React from "react";
import * as classes from "./App.module.scss";  // <-- Импортируется так

export const App = () => {
  return (
    <div>
      <p className={classes.nicep}>Hello, world!</p>
    </div>
  )
}
```

В папку src рядом с index.tsx кладем файл с названием `global.d.ts` TODO: что это вообще такое? Как оно работает? Почему файл называется именно так?

```typescript
declare module "*.module.scss" {
  interface IClassNames {
    [className: string]: string
  }
  const classNames: IClassNames;
  export = classNames;
}
```

https://qna.habr.com/q/1161862

https://stackoverflow.com/questions/41336858/how-to-import-css-modules-with-typescript-react-and-webpack

Раздел конфига вебпак, посвященный лоадерам ([Документация](https://webpack.js.org/loaders/css-loader/#modules)):

```typescript
import { ModuleOptions } from "webpack";
import { BuildOptions } from "./types/types";
import MiniCssExtractPlugin from "mini-css-extract-plugin";

export function buildLoaders(options: BuildOptions): ModuleOptions["rules"] {
  const isDev = options.mode === "development";

  const cssLoaderWithModules = {  // <-- Раз
    loader: "css-loader",
    options: {
      modules: {
        localIdentName: isDev ? "[path][name]__[local]" : "[hash:base64:8]"
      },
    },
  }

  const scssLoader = {
    test: /\.s[ac]ss$/i,
    use: [
      isDev ? "style-loader" : MiniCssExtractPlugin.loader,
      cssLoaderWithModules,  // <-- Два
      "sass-loader",
    ],
  };

  const tsLoader = {
    test: /\.tsx?$/,
    use: 'ts-loader',
    exclude: /node_modules/,
  };

  return [
    scssLoader,
    tsLoader
  ];
}
```

`localIdentName` отвечает за имена стилей на странице, а не за имя файла со стилями.