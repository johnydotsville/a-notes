# Условная отрисовка

С помощью JS-вставок можно делать условную отрисовку, т.е. на основе некоторого условия отрисовывать или не отрисовывать компонент, или отрисовывать разные компоненты.

## Рисовать \ не рисовать компонент

```react
{flag && <div>{message}</div>}
```

Используется, когда надо показать или скрыть компонент на основе условия. Данная конструкция работает так: если выражение на месте flag является true, тогда вычисляется следующее выражение. Поскольку `<div>` это объект, то он в любом случае считается за true и оператор && его возвращает (про операторы &&, || и т.д. есть конспекты в разделе про продвинутый синтаксис языка). Соответственно, если выражение flag false, тогда оператор && возвращает false. Когда реакт получает false, он ничего не отрисовывает, а когда получает компонент, то отрисовывает этот компонент.

Важно! Не надо использовать цифры в качестве условия. 0 для реакта это не false, а именно 0, т.е. обычные данные, которые он отрисует как и любые другие. Надо писать условие с цифрами явно, например `(messageCount > 0) && <MessageList />`

## Рисовать один или другой компонент

```react
{flag ? <div>{message}</div> : <span>{report}</span>}
```

Используется, когда надо на основе условия показать один или другой компонент. Если flag = true, то отрисовать div с сообщением внутри, а если flag = false, то span с отчетом. На практике вместо таких простых элементов могут отображаться более сложные компоненты.

## Вызвать одну или другую функцию

```react
<div>{flag ? sayHi() : sayGoodbye()}</div>
```

Вызов одной или другой функции на основе значения флага.

# Дополнительные возможности

## Несколько вставок друг за другом

```react
<div>{message} {flag ? "✔" : null}</div>
```

Демонстрация того, что несколько выражений `{ }{ }` могут идти друг за другом, а также того, что null можно использовать в случаях, когда не нужно ничего отрисовывать.

## Размещение вставки на нескольких строках

```react
<div style={flag ? {backgroundColor: 'green'} : {backgroundColor: 'red'}}>
  {flag ? message : (
      <del>
        message
      </del>
    ) 
  }
</div>
```

Когда конструкции в условии располагаются на нескольких строках, могут понадобиться круглые скобки для улучшения читаемости и предотвращения трудноуловимых ошибок.

# Замена картинки, если нужная отсутствует

P.S. Я не знал, куда лучше поместить эту проблему и как ее назвать, поэтому пока что поместил сюда и назвал как назвал.

* Ситуация: у нас есть массив имен картинок, которые надо отрисовать. Мы склеиваем путь до папки с картинками, имя картинки и получаем значение src для img. Но может быть так, что в папке нет нужной картинки. В этом случае нам надо отрисовать какую-нибудь картинку-заглушку.
* В чем интерес: мы не можем, как на бэке, проверить есть ли картинка в папке. У браузера такой возможности нет.
* Решение: используем событие onError на элементе картинки и если происходит ошибка, то в ее обработчике изменяем состояние компонента. Компонент перерисовывается и мы получаем возможность указать путь до картинки-заглушки.

```react
export const Player({ avatar }) => {
  const [avatarLoadingError, setAvatarLoadingError] = useState(false);

  const avatarImg = avatarLoadingError ? "fake_avatar" : avatar;
  const avatarImgPath = `/assets/img/players/${avatarImg}.png`;

  const handleAvatarLoadingError = () => setAvatarLoadingError(true);

  return (
    <div>
      <img  src={heroimgPath} onError={handleAvatarLoadingError} />
    </div>
  )
}
```

Если картинки по указанному url не окажется, браузер сгенерирует ошибку. Из-за изменения состояния произойдет ре-рендер компонента и url склеится по-новой, но на этот раз в нем будет путь до заглушки.