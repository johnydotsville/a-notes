# Итератор

## Что такое итератор

Итератор - это специальный объект, который позволяет сделать другой объект "перебираемым" в цикле `for ... of`. Итератор обязан содержать метод `next()`, который возвращает объект такого вида:

```javascript
{
  done: true \ false,
  value: значение следующего элемента, если он есть
}
```

## Как добавить объекту итератор

► Для начала нужно создать объект:

```javascript
function Range(from, to) {  // Для примера, создадим его через конструктор.
  this.from = from;
  this.to = to;
}

let range = new Range(1, 7);
```

► Добавить этому объекту функцию, которая вернет итератор. Класть ее надо в специальный символ `[Symbol.iterator]`:

```javascript
range[Symbol.iterator] = function() {
  return {
    current: this.from,  // <-- Этот this указывает на объект, на котором
    last: this.to,  // вызван метод получения итератора
    next() {
      return (this.current <= this.last) ?  // <-- Этот this уже указывает на сам итератор
        { done: false, value: this.current++ } :
        { done: true }
    }
  };
};
```

► Готово. Можно пользоваться итератором:

```javascript
// Неявно:
for (let item of range) {
  console.log(item);
}

// Явно, для демонстрации:
let rator = range[Symbol.iterator]();  // <-- Получаем итератор.
while (true) {
  let item = rator.next();  // <-- Явно вызываем его метод next()
  if (item.done) break;  // <-- Анализируем, вернулся ли очередной элемент.
  console.log(item.value);
}
```

# Преобразование итерируемого объекта в массив

Такое преобразование методом `Array.from(obj [, mapFn, thisArg])`. Необязательные параметры: mapFn - это функция, которую нужно применить к элементу перед добавлением в итоговый массив, а thisArgs - значение this для этой функции.

Возьмем объект range из примера выше и преобразуем в массив:

```javascript
let arr = Array.from(range);  // [1, 2, 3, 4, 5, 6, 7]
```

Или любой другой итерируемый объект, например строку:

```javascript
let message = "Hello";
let arr = Array.from(message);  // ['H', 'e', 'l', 'l', 'o']
```

