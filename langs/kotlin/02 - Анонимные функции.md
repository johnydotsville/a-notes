# Зачем нужны

Анонимные функции или, проще говоря, "лямбды". Назначение у них такое же как и везде - чтобы передавать функции в другие функции и чтобы хранить функции в переменных. Например, в подсчет символов передать предикат с условием, какие символы считать:

```kotlin
val result = "Kafka".count({ letter -> letter == 'a' });
println(result);  // 2
```

# Синтаксис базовый

## Тело

Тело лямбды заключается в фигурные скобки `{ }`

## return не нужен

В анонимных функциях не используется return. Считается, что ее результат - это ее последняя строка:

```kotlin
println({
    val word = "Mississippi";
    val letter = 'i';
    var cnt = word.count({ l -> l == letter });
    "В слове $word $cnt букв $letter";  // Это и будет результатом
}());  // Чтобы вызвать анонимную функцию, нужны скобки ()
```

В данном примере мы еще и вызываем анонимную функцию, указывая (), чтобы полученный результат уже ушел в println.

## Тип анонимной функции

Отдельного слова в общем случае не имеет, а при объявлении переменной просто используется привычный по другим языкам лямбда-синтаксис:

```kotlin
val greeting: (String) -> String = { username ->
    "Hello, $username";
};
println(greeting("JohNy"));
```

В качестве типа здесь служит выражение `(String) -> String`, сообщающее о том, что у функции один параметр типа строка и тип результата тоже строка.

Автоматическое определение типов работает и для анонимных функций, так что можно было бы сократить:

```kotlin
val twoParamsCompact = { num1: Int, num2: Int ->
    if (num1 > num2) "$num1 > $num2" else "$num1 < $num2";
};
```

В этом случае типы параметров надо просто указать после их имен.

## Без параметров и с параметрами

* Когда параметров нет:

  ```kotlin
  val noParams: () -> String = {
      "Привет, я анонимная функция без параметров";
  }
  ```

* Один параметр:

  ```kotlin
  val singleParam: (String) -> String = { username ->
      "Привет, $username! Я анонимная функция с одним параметром";
  }
  ```

  Причем, когда параметр ровно один, можно сократить синтаксис, убрав из него имя параметра и вместо этого использовать ключевое слово `it`:

  ```kotlin
  val singleParam: (String) -> String = {
      "Привет, $it! Я анонимная функция с одним параметром";
  }
  ```

  Если воспользоваться сокращенным синтаксисом и убрать `(String) -> String`, тогда `it` перестанет быть доступной.

* Два и более параметров:

  ```kotlin
  val twoParams: (Int, Int) -> String = { num1, num2 ->
      if (num1 > num2) "$num1 > $num2" else "$num1 < $num2";
  };
  ```

# Синтаксис похитрее

## Лямбды как параметры



```kotlin
fun main(args: Array<String>) {
    val rankDetectionAlgo = { mmr: Int ->
        when (mmr) {
            in 0..1000 -> "Совсем днище"
            in 1000..2000 -> "Лох"
            in 2000..3000 -> "Работяга"
            in 3000..4000 -> "Задрот"
            else -> "Кибератлет (нет)"
        };
    };
    val status = lambdaInParams("Johny", 2700, rankDetectionAlgo);
    println(status);
}

private fun lambdaInParams(username: String, mmr: Int, rankDetection: (Int) -> String) =
    "Ранг $username соответствует статусу ${rankDetection(mmr)}";
```

