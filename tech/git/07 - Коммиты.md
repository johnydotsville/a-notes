# Коммиты

## Обычный коммит

* С коротким сообщением:

  ```
  git commit -m "Если сообщение короткое, можно ввести его через ключ -m"
  ```

* С длинным сообщением (откроется vi для ввода текста сообщения):

  ```
  git commit
  ```

  Краткая справка: когда vi откроется, нажимаем `i` (раскладка должна быть английская, иначе не поймет), чтобы перейти в режим ввода текста. Вводим текст сообщения к коммиту, можно многострочный, через Enter как в обычном блокноте. Когда ввели все, что хотели, нажимаем `Esc`, чтобы перейти в режим команд, набираем `:wq` (write-and-quit), жмем `Enter`, и происходит коммит.

## Частичный коммит

Пользуемся для этого дефолтным графическим интерфейсом:

* Выделяем фрагмент, который хотим закоммитить (нужно выделять как добавленные строки, так и удаленные).
* *ПКМ > Stage Lines For Commit* чтобы добавить выделенное в стейдж (чтобы удалить потом это из стейджа, см конспект по стейджу).

<img src="img/partial-commit-lines.png" alt="partial-commit-lines" style="zoom:80%;" />

В данном случае мы видим, что в файл *добавлены* две строки комментариев, *удалена* строка с печатью "Hello, git", а вместо нее оставлена пустая. Допустим мы хотим выполнить частичный коммит и закоммитить только удаление строки. Поэтому мы выделяем изменения как показано в правой части скрина и выбираем для коммита только их. После выполнения коммита можно убедиться, что комментарии в него не попали.

## Прибавить код к последнему коммиту

Применять эту операцию нужно исключительно к локальным коммитам.

1. Кладем изменения в стейдж.

2. Добавляем изменения к ласт коммиту:

   * Не меняя сообщение коммита:

     ```
     git commit --amend --no-edit
     ```

   * Заменяя сообщение коммита на новое:

     * Сообщение короткое:

       ```
       git commit --amend -m "Если хотим изменить сообщение и оно короткое"
       ```

     * Если сообщение длинное, то введем его через vi:

       ```
       git commit --amend
       ```

## Изменить сообщение к последнему коммиту

```
// НЕ добавляем никаких файлов в стейдж!
git commit --amend -m "Новое сообщение заменит старое"
git commit --amend  // Если хотим редактировать сообщение в vi
```

Применять эту команду нужно исключительно к локальным коммитам

## Объединить коммиты

Делается через интерактивный rebase, см. раздел про ребейз

## Откатиться на указанный коммит с удалением изменений

Все, что было *после* указанного коммита - исчезнет (cb42b1650 - начальная часть id коммита):

```
git reset cb42b1650 --hard
```



