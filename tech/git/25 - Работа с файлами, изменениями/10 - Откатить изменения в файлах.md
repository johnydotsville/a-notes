# Откатить изменения в файле

```
git restore
```

git restore концептуально предназначен для отката изменений в файлах. git reset концептуально предназначен для манипулирования указателями веток. Это косвенно тоже приводит к откату файлов, но git reset лучше не использовать для этих целей.

## Откатить до состояния индекса

```
git restore foobar/Person.ts
```

Сценарий такой: у нас был файл, мы что-то в нем поправили и добавили в индекс. Потом еще что-то поправили  и хотим откатиться до состояния, которое лежит в индексе.

Если в индексе этого файла нет, то он откатится до состояния как в последнем коммите. 

P.S. А если его и в коммите нет, значит это новый untracked-файл и никакого отката не произойдет, т.к. гит о файле не знает вообще.

## Откатить до состояния ласт коммита

```
git restore --source=HEAD foobar/Person.ts
```

Флаг `--source` позволяет явно указать коммит, из которого надо восстановить файл. Соответственно, если указать --source с коммитом, и не ставить флаг --staged, тогда рабочий файл восстановится сразу из коммита. Т.е. сделает скачок "рабочка < коммит", минуя состояние индекса.

Сценарий такой: у нас был файл, мы что-то в нем поправили. Могли добавить эти изменения в индекс (а могли и не добавлять). Как бы то ни было, теперь мы хотим откатить рабочий файл до состояния как в последнем коммите.

Если мы добавляли изменения в индекс, то они там останутся, т.е. эта команда индекс не затронет, только рабочую директорию.

Можно сделать сброс до ласт коммита за две команды: сначала восстановить из коммита в индекс, а потом уже из индекса в рабочку:

```
git restore --staged foobar/Person.ts  ; Сначала восстанавливаем из коммита в индекс.
git restore foobar/Person.ts           ; Потом восстанавливаем из индекса в рабочку.
```

Но это скорее просто для общего развития, в реальности так делать нет смысла, т.к. через одну команду быстрее.

## Откатить до состояния указанного коммита

```
git restore --source=ab34fe7 foobar/Person.ts
```

Просто указываем первые несколько букв из хэша коммита, из которого хотим брать состояние файла.

Если вдруг этого файла в том коммите вообще не было, тогда он удалится из рабочей директории. Если не понятно, почему это так работает, см конспект про "движение файла, add vs restore", там рассказана механика.

# Откатить изменения во всех файлах

До ласт коммита:

```
git restore --source=HEAD .
```

Просто заменяем имя файла на точку `.` а все остальные правила такие же как и для одного файла.

P.S. Раньше тут стояла команда `git reset .`

# Через GUI

Если делать через GUI - выделяем нужный файл и `Ctrl + J` или меню `Commit > Revert changes`.