

# Создаем ключи

Нужно создать для каждого аккаунта ssh-ключ.

* Создаем папку `.ssh` в корневой директории своего юзера (если она еще не существует):

  ```
  mkdir ~/.ssh
  ```

* Переходим в эту папку:

  ```
  cd ~/.ssh
  ```

* Создаем по паре ключей (приватный и публичный) для каждого аккаунта:

  ```
  ssh-keygen -t rsa -C "for-programming" -f "git-for-programming"
  и для второго, третьего все аналогично
  ```

  * `-C` - просто комментарий, с описанием для чего предназначен ключ.
  * `-f` - имя файла, в который ключ будет сохранен.

  И туда, и туда можно в общем-то ввести все что угодно. С логической точки зрения это ни на что не влияет. После ввода команды терминал попросит ввести кодовую фразу. Ее можно оставить пустой. 

  Каждая команда создаст два файла - с публичным ключом (заканчивается на `.pub`) и приватным.

# Добавляем приватные ключи в SSH Agent

* Добавляем приватные ключи в агент, указывая имя файла (которое без `.pub`):

  ```
  ssh-add -K ~/.ssh/git-for-programming
  аналогично для остальных приватных ключей
  ```

# Добавляем публичные ключи в git-аккаунт

* Копируем *публичный* ключ (тот что с `.pub` в конце имени файла) в буфер обмена такой командой:

  ```
  pbcopy < ~/.ssh/git-for-programming.pub
  ```

* Логинимся в гит-аккаунт.

* Жмем на свой аватар в правом верхнем углу и переходим в `Settings`.

* Там ищем в левом меню пункт `SSH and GPG keys`.

* Жмем кнопку `New SSH key`.

* Вводим произвольное имя для ключа, вставляем сам ключ в нужное поле и жмем кнопку Add.

* Повторяем для остальных аккаунтов и ключей.

# Создаем файл конфига SSH Agent

* Создаем файл конфига (если он еще не создан):

  ```
  touch ~/.ssh/config
  ```

* Открываем его:

  ```
  open ~/.ssh/config
  ```

* Вводим конфиг для всех аккаунтов:

  ```
  # Аккаунт для программирования
  Host github.com-programming
       HostName github.com
       User git
       IdentityFile ~/.ssh/git-for-programming
       
  # Аккаунт НЕ для программирования
  аналогично, только Host указываем другой, например, github.com-no-programming.
  Ну и файл с приватным ключом конечно же тоже другой.
  ```

  Здесь в первой строке нужно задать идентификатор, который понадобится в будущем при клонировании репозиториев, так что имя надо дать хорошее. В IdentityFile задаем файл с *приватным* ключом.

# Клонируем репозитории, используя нужные аккаунты

* Теперь надо склонировать репозитории, воспользовавшись созданными аккаунтами:

  ```
  git@github.com-programming:johnydotsville/a-notes.git
  ```

  Здесь после `@` мы указываем идентификатор, под которым добавляли настройки в config-файл из прошлого шага. Соответственно, клонировать репозиторий надо через тот идентификатор, под которым указан соответствующий приватный ключ.

  После `:` указывается реальное имя гит-юзера и репозиторий.

  При первом клонировании может ругаться что невозможно установить соединение и спросит, надо ли продолжать. Отвечаем yes, надо, и после этого все будет нормально.

* Настраиваем имя пользователя и почту, которые будут вставлены в коммиты:

  ```
  git config user.name "имяПользователя"
  git config user.email "почта@домен.ru"
  ```

* Все, можно коммитить и пушить.



