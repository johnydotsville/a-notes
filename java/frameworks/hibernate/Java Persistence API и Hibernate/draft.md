```
??? неоднозначные утверждения
!!! утверждения входят в конфликт с прочитанным в других местах
```



# Архитектура

Java EE, она же Jakarta EE - это набор спецификаций. JPA - одна из них. А Hibernate - это реализация спецификации JPA. Понял, да?

В Hibernate одно из важных понятий на старте является *сущность* (entity).

<img src="img/image-20220601092721459.png" alt="image-20220601092721459" style="zoom:80%;" />

Для напоминания:

* Каждый уровень взаимодействует только с уровнем, лежащим непосредственно под ним, и ничего не знает о других уровнях.
* Программируем на основе интерфейсов - каждый уровень зависит от интерфейсов, а не от конкретных реализаций с нижележащего уровня. ??? Тут есть вопрос - где размещать интерфейсы - в верхнем уровне или нижнем? А может быть вообще в отдельном пакете? Тогда реализация ничего не будет знать о пользователе, а пользователь - о реализации, и оба они будут зависеть только от "спецификации".

Интересным было то, что все слои работают классами доменной модели. ??? Впрочем, далее было написано, что у слоев могут быть и свои "вариации" этих классов. Например, если уровень представления работает на другом компьютере, то ему очевидно недоступны напрямую сущности, и требуется какой-то промежуточный класс для передачи. Для других случаев нужны конкретные примеры, а просто представить это, придумать самому, как-то смутно.

В домене находятся, грубо говоря, два типа сущностей:

* Хранимые - т.е. объекты, которые непосредственно будут сохраняться\извлекаться из БД
* "Не хранимые" - эти, соответственно, сохранять не требуется. Например, какие-нибудь объекты со стратегиями вычисления цены и подобное.

Одним словом, пока предполагается, что доменные сущности используются в хранении непосредственно сами.

!!! Кроме того, было написано, что сущности-таки могут иметь поведение. Т.е. POJO классу не запрещается иметь "мозги", а не просто геттеры и сеттеры. Как-то специально читать про POJO не хочу, потому что уже почитал... Только смуту наводит. Думаю с практикой автоматически придет понимание, что они есть такое.

!!! Код предметной области не должен обращаться к JDBC ни напрямую, ни через промежуточные абстракции. Однако в юлиане у нас сервисы работают с репозиториями. А репозиторий - не что иное, как абстракция над JDBC. И в принципе выглядит довольно логично. Пока не могу представить, как обойтись без этого.

Hibernate в целом дает *прозрачность* хранения. Это значит, что класс сущности почти не надо как-то особенным образом оформлять, чтобы гибернейт мог его сохранить. Кое-какие ограничения конечно есть, например:

* Должен обязательно быть id
* Коллекции должны иметь тип интерфейса, а не конкретной коллекции
* Не может быть вложенным классом
* Не может быть финальным (и финальных методов в нем тоже быть не должно)
* Другое)

Есть разные допущения насчет того, что конструктор может быть не обязательно публичным, но точно не приватным, что свойства могут не иметь геттеров\сеттеров, но тогда надо отдельно возиться. Короче говоря, есть разные штуки, которые должны проясниться в процессе, а разбираться в них насухую сейчас - только время тратить.